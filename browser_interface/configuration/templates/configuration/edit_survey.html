{% load static %}
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Photometric Survey Configuration</title>
        <link rel="stylesheet" href="{% static 'css/style.css' %}">
        <link rel="stylesheet" href="{% static 'css/navbar.css' %}">
        <link rel="stylesheet" href="{% static 'configuration/css/survey.css' %}">
    </head>
    <body>
        <div class="navbar" id="navbar">
            <div class="dropdown dropdown-right" >
                <a class="dropbtn" href="{% url 'processing:progress' %}">
                    Processing Status
                </a>
            </div>
            <div class="dropdown dropdown-right" >
                <a class="dropbtn" href="{% url 'configuration:config_tree' %}">
                    Processing Configuration
                </a>
            </div>
        </div>
        {% with 'camera telescope mount' as equipment_components_str %}
        {% with equipment_components_str.split as equipment_components %}
        <div id="survey" 
             class="survey-container" 
             style="grid-template-columns: auto auto">
            <div class="survey-item">
                <table>
                    <tr>
                        {% if selected_component in equipment_components %}
                        <th>Access to <br/>{{selected_component}}</th>
                        <th>Observers</th>
                        {% else %}
                        <th colspan=2>Observers</th>
                        {% endif %}
                    </tr>
                    {% with component='observer' %}
                    {% for item in observers %}
                    {% if selected_component in equipment_components %}
                    {% include "./survey_item_access.html" %}
                    {% else %}
                    {% include "./survey_item_noaccess.html" %}
                    {% endif %}
                    {% endfor %}
                    {% include "./survey_add_item.html" with attributes=attributes.observer %}
                    {% endwith %}
                </table>
            </div>
            <div class="survey-item">
                <table>
                    <tr>
                        <th colspan=2>Observatories</th>
                    </tr>
                    {% for obs in observatories %}
                    {% include "./survey_item_noaccess.html" with item=obs component='observatory'%}
                    {% endfor %}
                    {% include "./survey_add_item.html" with component='observatory' attributes=attributes.observatory%}
                </table>
            </div>
        </div>
        <br/>
        <div id="survey" class="survey-container" style="grid-template-columns: auto auto auto">
            {% for component in equipment_components %}
            <div class="survey-item">
                <table>
                    <tr>
                        {% if selected_component == 'observer' %}
                        <th>Observer has<br/>Access</th>
                        <th>{{component.title}}s</th>
                        {% else %}
                        <th colspan=2>{{component.title}}s</th>
                        {% endif %}
                    </tr>
                    {% cycle cameras telescopes mounts as equipment_list silent %}
                    {% cycle attributes.camera attributes.telescope attributes.mount as component_attributes silent %}
                    {% cycle types.camera types.telescope types.mount as component_types silent %}
                    {% cycle type_attributes.camera type_attributes.telescope type_attributes.mount as component_type_attrs silent %}


                    {% for item in equipment_list %}
                    {% if selected_component == 'observer' %}
                    {% include "./survey_item_access.html" %}
                    {% else %}
                    {% include "./survey_item_noaccess.html" %}
                    {% endif %}
                    {% endfor %}
                    {% include "./survey_add_item.html" with attributes=component_attributes types=component_types type_attributes=component_type_attrs%}
                </table>
            </div>
            {% endfor %}
        </div>
        {% endwith %}
        {% endwith %}

    </body>
</html>
